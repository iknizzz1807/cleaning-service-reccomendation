<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Uploader & Settings</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="main-container">
      <!-- Tab Navigation -->
      <div class="tab-nav">
        <button class="tab-button active" data-tab="uploader">Uploader</button>
        <button class="tab-button" data-tab="settings">Settings</button>
        <!-- NEW TAB BUTTON -->
        <button class="tab-button" data-tab="scoring">Scoring & Ranking</button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Uploader Panel -->
        <div id="uploader-panel" class="tab-panel active">
          <div class="uploader-card">
            <h1>File Uploader</h1>
            <p class="subtitle">Select a file and click upload</p>
            <input
              type="file"
              id="file-input"
              accept=".txt, .jpg, .png"
              hidden
            />
            <label for="file-input" class="file-label">Choose File</label>
            <div id="file-info-container">
              <span id="file-name">No file chosen</span>
            </div>
            <div id="preview-container"></div>
            <button id="submit-btn">
              <span class="btn-text">Upload</span>
              <div class="spinner" hidden></div>
            </button>
            <div id="result-container"></div>
          </div>
        </div>

        <!-- Settings Panel -->
        <div id="settings-panel" class="tab-panel">
          <div class="settings-card">
            <h1>Mess Configuration</h1>
            <p class="subtitle">
              Select a mess type, then assign services to it.
            </p>
            <div class="settings-columns">
              <div class="settings-column">
                <h3>Mess Types</h3>
                <div id="mess-list-container" class="item-list-container"></div>
              </div>
              <div class="settings-column">
                <h3>Services</h3>
                <div class="service-creator">
                  <input
                    type="text"
                    id="new-service-input"
                    placeholder="Enter new service name"
                  />
                  <button id="add-service-btn">Create</button>
                </div>
                <div
                  id="service-checklist-container"
                  class="checklist-container"
                ></div>
              </div>
            </div>
          </div>
        </div>

        <!-- NEW SCORING & RANKING PANEL -->
        <div id="scoring-panel" class="tab-panel">
          <div class="settings-card">
            <h1>Scoring & Ranking Rules</h1>
            <p class="subtitle">
              Customize how service scores are calculated and ranked.
            </p>
            <div class="scoring-sections-container">
              <!-- Section 1: Score Calculation Method -->
              <div class="scoring-section">
                <h3>1. Score Aggregation Method</h3>
                <p class="section-description">
                  Choose the formula to calculate a service's score based on the
                  confidence of its related messes.
                </p>
                <div id="scoring-method-container">
                  <label class="scoring-method-option">
                    <input
                      type="radio"
                      name="score-method"
                      value="average"
                      checked
                    />
                    <span
                      ><strong>Average Confidence (Default):</strong> Score is
                      the average confidence of all detected messes.</span
                    >
                  </label>
                  <label class="scoring-method-option">
                    <input type="radio" name="score-method" value="max" />
                    <span
                      ><strong>Maximum Confidence:</strong> Score is the highest
                      confidence of any single detected mess.</span
                    >
                  </label>
                  <label class="scoring-method-option">
                    <input type="radio" name="score-method" value="sum" />
                    <span
                      ><strong>Sum of Confidence:</strong> Score is the total
                      sum of confidences. Rewards services linked to many
                      messes.</span
                    >
                  </label>
                  <label class="scoring-method-option">
                    <input type="radio" name="score-method" value="count" />
                    <span
                      ><strong>Detection Count:</strong> Score is simply the
                      number of messes detected for that service.</span
                    >
                  </label>
                </div>
              </div>

              <!-- Section 2: Mess Severity -->
              <div class="scoring-section">
                <h3>2. Mess Type Severity (Weighting)</h3>
                <p class="section-description">
                  Assign a weight to each mess type. A higher weight means it
                  contributes more to the final score.
                </p>
                <div
                  id="mess-severity-list-container"
                  class="item-list-container"
                >
                  <!-- Severity sliders will be dynamically inserted here -->
                </div>
              </div>

              <!-- Section 3: Final Sorting -->
              <div class="scoring-section">
                <h3>3. Final Ranking Order</h3>
                <p class="section-description">
                  How should the final list of suggested services be sorted?
                </p>
                <select id="sorting-rule-select" class="custom-select">
                  <option value="score_desc" selected>
                    By Highest Score (Recommended)
                  </option>
                  <option value="score_asc">By Lowest Score</option>
                  <option value="alpha_asc">Alphabetically (A-Z)</option>
                  <option value="alpha_desc">Alphabetically (Z-A)</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
